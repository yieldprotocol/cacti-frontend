"use strict";(self.webpackChunkchatweb3_frontend=self.webpackChunkchatweb3_frontend||[]).push([[7462],{"./src/components/cactiComponents/ActionResponse.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{_:()=>ActionResponse,v:()=>ActionResponseState});var defineProperty=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),taggedTemplateLiteral=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/@babel/runtime/helpers/esm/taggedTemplateLiteral.js"),react=__webpack_require__("./node_modules/react/index.js"),chunk_GEBDUYT7=__webpack_require__("./node_modules/@rainbow-me/rainbowkit/dist/chunk-GEBDUYT7.js"),tailwind_styled_components_esm=__webpack_require__("./node_modules/tailwind-styled-components/dist/tailwind-styled-components.esm.js"),dist=__webpack_require__("./node_modules/wagmi/dist/index.js"),asyncToGenerator=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js"),regenerator=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/@babel/runtime/regenerator/index.js"),regenerator_default=__webpack_require__.n(regenerator),SettingsContext=__webpack_require__("./src/contexts/SettingsContext.tsx"),axios=__webpack_require__("./node_modules/axios/lib/axios.js"),json_rpc_provider=__webpack_require__("./node_modules/@ethersproject/providers/lib.esm/json-rpc-provider.js"),lib_esm=__webpack_require__("./node_modules/@ethersproject/bytes/lib.esm/index.js"),immutable_dist=__webpack_require__("./node_modules/swr/immutable/dist/index.mjs");const hooks_useForkTools=function useForkTools(id){var settings=(0,react.useContext)(SettingsContext.ZP).settings,isForkedEnv=settings.isForkedEnv,forkId=settings.forkId,forkUrl="https://rpc.tenderly.co/fork/".concat(id||forkId),account=(0,dist.mA)().address,refetch=(0,dist.KQ)({address:account}).refetch,provider=(0,dist.yL)(),forkProvider=(0,react.useMemo)((function(){return forkUrl?new json_rpc_provider.r(forkUrl):void 0}),[forkUrl]),forkSigner=isForkedEnv&&forkUrl?null==forkProvider?void 0:forkProvider.getSigner(account):void 0,createNewFork=(0,react.useCallback)((0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var forkAPI,currentBlockNumber,resp;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:return forkAPI="http://api.tenderly.co/api/v1/account/".concat("Yield","/project/").concat("chatweb3","/fork"),_context.next=3,provider.getBlockNumber();case 3:return currentBlockNumber=_context.sent,_context.next=6,axios.Z.post(forkAPI,{network_id:1,block_number:currentBlockNumber},{headers:{"X-Access-Key":"tKosvsANtW4pI7YUzIACLNSfGr01I2Nr"}});case 6:return resp=_context.sent,_context.abrupt("return","https://rpc.tenderly.co/fork/".concat(resp.data.simulation_fork.id));case 8:case"end":return _context.stop()}}),_callee)}))),[provider]),getForkTimestamp=(0,react.useCallback)((0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(){var _yield$provider$getBl,timestamp;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(isForkedEnv&&provider){_context2.next=2;break}return _context2.abrupt("return");case 2:return _context2.prev=2,_context2.next=5,provider.getBlock("latest");case 5:return _yield$provider$getBl=_context2.sent,timestamp=_yield$provider$getBl.timestamp,console.log("Updated Forked Blockchain time: ",new Date(1e3*timestamp)),_context2.abrupt("return",timestamp);case 11:return _context2.prev=11,_context2.t0=_context2.catch(2),console.log("Error getting latest timestamp",_context2.t0),_context2.abrupt("return",void 0);case 15:case"end":return _context2.stop()}}),_callee2,null,[[2,11]])}))),[provider,isForkedEnv]),getForkStartBlock=(0,react.useCallback)((0,asyncToGenerator.Z)(regenerator_default().mark((function _callee3(){var num,sBlock;return regenerator_default().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:if(isForkedEnv&&provider){_context3.next=2;break}return _context3.abrupt("return","earliest");case 2:return _context3.prev=2,_context3.next=5,null==forkProvider?void 0:forkProvider.send("tenderly_getForkBlockNumber",[]);case 5:return num=_context3.sent,sBlock=+num.toString(),console.log("Fork start block: ",sBlock),_context3.abrupt("return",sBlock);case 11:return _context3.prev=11,_context3.t0=_context3.catch(2),console.log("Could not get tenderly start block: ",_context3.t0),_context3.abrupt("return","earliest");case 15:case"end":return _context3.stop()}}),_callee3,null,[[2,11]])}))),[isForkedEnv,provider,forkProvider]),fillEther=(0,react.useCallback)((0,asyncToGenerator.Z)(regenerator_default().mark((function _callee4(){var transactionParameters;return regenerator_default().wrap((function _callee4$(_context4){for(;;)switch(_context4.prev=_context4.next){case 0:if(provider&&isForkedEnv){_context4.next=2;break}return _context4.abrupt("return");case 2:return _context4.prev=2,transactionParameters=[[account],lib_esm.hexValue(BigInt("100000000000000000000"))],_context4.next=6,null==forkProvider?void 0:forkProvider.send("tenderly_addBalance",transactionParameters);case 6:refetch(),console.log("Filled eth on fork"),_context4.next=13;break;case 10:_context4.prev=10,_context4.t0=_context4.catch(2),console.log("Could not fill eth on Tenderly fork");case 13:case"end":return _context4.stop()}}),_callee4,null,[[2,10]])}))),[provider,isForkedEnv,account,forkProvider,refetch]);return{forkTimestamp:(0,immutable_dist.Z)(isForkedEnv?["forkTimestamp",forkUrl]:null,getForkTimestamp).data,forkStartBlock:(0,immutable_dist.Z)(isForkedEnv?["forkStartBlock",forkUrl]:null,getForkStartBlock).data,createNewFork,fillEther,provider:forkProvider,signer:forkSigner}};const hooks_useSigner=function useSigner(){var isForkedEnv=(0,react.useContext)(SettingsContext.ZP).settings.isForkedEnv,wagmiSigner=(0,dist.mx)().data,forkSigner=hooks_useForkTools().signer;return isForkedEnv?forkSigner:wagmiSigner};const hooks_useSubmitTx=function useSubmitTx(request,onSuccess,onError){var signer=hooks_useSigner(),_useState=(0,react.useState)(),hash=_useState[0],setHash=_useState[1],_useState2=(0,react.useState)(!1),isPending=_useState2[0],setIsPending=_useState2[1],_useState3=(0,react.useState)(!1),isPrepared=_useState3[0],setIsPrepared=_useState3[1],_useState4=(0,react.useState)(),error=_useState4[0],setError=_useState4[1],prepare=(0,react.useCallback)((0,asyncToGenerator.Z)(regenerator_default().mark((function _callee(){var gasLimit;return regenerator_default().wrap((function _callee$(_context){for(;;)switch(_context.prev=_context.next){case 0:if(!1,gasLimit=null==request?void 0:request.gasLimit,request){_context.next=4;break}return _context.abrupt("return",{isPrepared:false,gasLimit});case 4:return _context.prev=4,_context.next=7,null==signer?void 0:signer.estimateGas(request);case 7:gasLimit=_context.sent,setIsPrepared(!0),_context.next=16;break;case 11:_context.prev=11,_context.t0=_context.catch(4),console.error("Error preparing",_context.t0),setError(_context.t0),setIsPrepared(!1);case 16:case"end":return _context.stop()}}),_callee,null,[[4,11]])}))),[request,signer]),submitTx=function(){var _ref2=(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee2(){var tx;return regenerator_default().wrap((function _callee2$(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:if(signer){_context2.next=2;break}throw new Error("No signer found");case 2:if(request){_context2.next=4;break}return _context2.abrupt("return",void 0);case 4:if(isPrepared){_context2.next=6;break}return _context2.abrupt("return",void 0);case 6:return setIsPending(!0),_context2.prev=7,_context2.next=10,signer.sendTransaction(request);case 10:tx=_context2.sent,setHash(tx.hash),setIsPending(!1),_context2.next=19;break;case 15:_context2.prev=15,_context2.t0=_context2.catch(7),setIsPending(!1),setError(_context2.t0);case 19:case"end":return _context2.stop()}}),_callee2,null,[[7,15]])})));return function submitTx(){return _ref2.apply(this,arguments)}}();(0,react.useEffect)((function(){(0,asyncToGenerator.Z)(regenerator_default().mark((function _callee3(){return regenerator_default().wrap((function _callee3$(_context3){for(;;)switch(_context3.prev=_context3.next){case 0:return _context3.next=2,prepare();case 2:case"end":return _context3.stop()}}),_callee3)})))()}),[prepare]);var _useWaitForTransactio=(0,dist.BX)({hash,onSuccess,onError}),isError=_useWaitForTransactio.isError,isLoading=_useWaitForTransactio.isLoading,isSuccess=_useWaitForTransactio.isSuccess;return{receipt:_useWaitForTransactio.data,hash,isLoading,isPendingConfirm:isPending,isSuccess,isError,submitTx,isPrepared,error}};var _templateObject,_stylingByState,__jsx=react.createElement,ActionResponseState=function(ActionResponseState){return ActionResponseState.PENDING="pending",ActionResponseState.SUCCESS="success",ActionResponseState.ERROR="error",ActionResponseState.DISABLED="disabled",ActionResponseState.LOADING="loading",ActionResponseState.DEFAULT="default",ActionResponseState}({}),StyledButton=tailwind_styled_components_esm.Z.button(_templateObject||(_templateObject=(0,taggedTemplateLiteral.Z)(["\ninline-flex items-center justify-center\nheight-[40px] w-[215px] w-max-[256px]\npy-[8px] px-[24px]\nrounded-[8px]\nborder-[1px] border-white border-opacity-10\nbg-[#2E8C87]\ntext-sm text-white/90\n"]))),stylingByState=(_stylingByState={},(0,defineProperty.Z)(_stylingByState,ActionResponseState.PENDING,"cursor-not-allowed"),(0,defineProperty.Z)(_stylingByState,ActionResponseState.SUCCESS,"bg-green-800"),(0,defineProperty.Z)(_stylingByState,ActionResponseState.ERROR,"bg-red-800"),(0,defineProperty.Z)(_stylingByState,ActionResponseState.DISABLED,"bg-opacity-50 text-white text-opacity-50 cursor-not-allowed"),(0,defineProperty.Z)(_stylingByState,ActionResponseState.LOADING,"cursor-not-allowed"),(0,defineProperty.Z)(_stylingByState,ActionResponseState.DEFAULT,""),_stylingByState),ActionResponse=function ActionResponse(_ref){var txAction=_ref.txAction,altAction=_ref.altAction,label=_ref.label,state=_ref.state,address=(0,dist.mA)().address,styleClassName=stylingByState[state],config=(0,dist.PJ)(txAction).config,_useSubmitTx=hooks_useSubmitTx(config.request);_useSubmitTx.isSuccess,_useSubmitTx.isError,_useSubmitTx.isLoading,_useSubmitTx.submitTx,_useSubmitTx.isPrepared,_useSubmitTx.error,_useSubmitTx.hash,_useSubmitTx.isPendingConfirm;return __jsx("div",{className:"flex w-full justify-center"},address?__jsx(StyledButton,{className:"bg-teal-900 ".concat(styleClassName),onClick:txAction||altAction},label||"Submit"):__jsx(chunk_GEBDUYT7.NL,null))};ActionResponse.displayName="ActionResponse",ActionResponse.__docgenInfo={description:"Action Response\nIncludes: Label, action, state, preparedContractWrite",methods:[],displayName:"ActionResponse",props:{txAction:{required:!1,tsType:{name:"any"},description:""},altAction:{required:!1,tsType:{name:"signature",type:"function",raw:"()=> Promise<any>",signature:{arguments:[],return:{name:"Promise",elements:[{name:"any"}],raw:"Promise<any>"}}},description:""},label:{required:!1,tsType:{name:"string"},description:""},state:{required:!1,tsType:{name:"ActionResponseState"},description:""}}};try{ActionResponse.displayName="ActionResponse",ActionResponse.__docgenInfo={description:"Action Response\nIncludes: Label, action, state, preparedContractWrite",displayName:"ActionResponse",props:{txAction:{defaultValue:null,description:"",name:"txAction",required:!1,type:{name:"any"}},altAction:{defaultValue:null,description:"",name:"altAction",required:!1,type:{name:"(() => Promise<any>)"}},label:{defaultValue:null,description:"",name:"label",required:!1,type:{name:"string"}},state:{defaultValue:null,description:"",name:"state",required:!1,type:{name:"enum",value:[{value:'"pending"'},{value:'"success"'},{value:'"error"'},{value:'"disabled"'},{value:'"loading"'},{value:'"default"'}]}}}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/components/cactiComponents/ActionResponse.tsx#ActionResponse"]={docgenInfo:ActionResponse.__docgenInfo,name:"ActionResponse",path:"src/components/cactiComponents/ActionResponse.tsx#ActionResponse"})}catch(__react_docgen_typescript_loader_error){}},"./src/contexts/SettingsContext.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{ZP:()=>__WEBPACK_DEFAULT_EXPORT__});var _Users_brucedonovan_dev_yield_chatweb3_frontend_node_modules_storybook_nextjs_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/@storybook/nextjs/node_modules/@babel/runtime/helpers/esm/defineProperty.js"),react__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/index.js"),react_hotkeys_hook__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./node_modules/react-hotkeys-hook/dist/react-hotkeys-hook.esm.js"),react_toastify__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/react-toastify/dist/react-toastify.esm.mjs"),__jsx=react__WEBPACK_IMPORTED_MODULE_0__.createElement;function ownKeys(object,enumerableOnly){var keys=Object.keys(object);if(Object.getOwnPropertySymbols){var symbols=Object.getOwnPropertySymbols(object);enumerableOnly&&(symbols=symbols.filter((function(sym){return Object.getOwnPropertyDescriptor(object,sym).enumerable}))),keys.push.apply(keys,symbols)}return keys}function _objectSpread(target){for(var i=1;i<arguments.length;i++){var source=null!=arguments[i]?arguments[i]:{};i%2?ownKeys(Object(source),!0).forEach((function(key){(0,_Users_brucedonovan_dev_yield_chatweb3_frontend_node_modules_storybook_nextjs_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_1__.Z)(target,key,source[key])})):Object.getOwnPropertyDescriptors?Object.defineProperties(target,Object.getOwnPropertyDescriptors(source)):ownKeys(Object(source)).forEach((function(key){Object.defineProperty(target,key,Object.getOwnPropertyDescriptor(source,key))}))}return target}var Setting=function(Setting){return Setting.APPROVAL_METHOD="approvalMethod",Setting.APPROVAL_MAX="approveMax",Setting.SLIPPAGE_TOLERANCE="slippageTolerance",Setting.DIAGNOSTICS="diagnostics",Setting.DARK_MODE="darkMode",Setting.DISCLAIMER_CHECKED="disclaimerChecked",Setting.FORCE_TRANSACTIONS="forceTransactions",Setting.FORKED_ENV="isForkedEnv",Setting.FORK_ENV_URL="forkEnvUrl",Setting.EXPERIMENTAL_UI="experimentalUi",Setting}({}),initState={approvalMethod:function(ApprovalType){return ApprovalType.TX="TX",ApprovalType.SIG="SIG",ApprovalType.DAI_SIG="DAI_SIG",ApprovalType}({}).SIG,approveMax:!1,slippageTolerance:.001,darkMode:!1,disclaimerChecked:!1,experimentalUi:!0,forceTransactions:!1,diagnostics:!1,isForkedEnv:!1,forkId:"902db63e-9c5e-415b-b883-5701c77b3aa7",forkEnvUrl:"https://rpc.tenderly.co/fork/".concat("902db63e-9c5e-415b-b883-5701c77b3aa7")},SettingsContext=(0,react__WEBPACK_IMPORTED_MODULE_0__.createContext)({settings:initState,changeSetting:function initChangeSetting(){return null}});function settingsReducer(state,action){return _objectSpread(_objectSpread({},state),{},(0,_Users_brucedonovan_dev_yield_chatweb3_frontend_node_modules_storybook_nextjs_node_modules_babel_runtime_helpers_esm_defineProperty_js__WEBPACK_IMPORTED_MODULE_1__.Z)({},action.type,function cacheAndUpdate(_action){return state[action.type]===_action.payload?state[action.type]:(localStorage.setItem(_action.type,JSON.stringify(_action.payload)),_action.payload)}(action)))}var SettingsProvider=function SettingsProvider(_ref){var children=_ref.children,_useReducer=(0,react__WEBPACK_IMPORTED_MODULE_0__.useReducer)(settingsReducer,initState),settings=_useReducer[0],updateState=_useReducer[1];(0,react_hotkeys_hook__WEBPACK_IMPORTED_MODULE_2__.y1)("alt+f",(function(){var currentSetting=settings.isForkedEnv;changeSetting(Setting.FORKED_ENV,!currentSetting),(0,react_toastify__WEBPACK_IMPORTED_MODULE_3__.Am)("".concat(currentSetting?"Fork disconnected. Working on mainnet.":"Switched to using a forked Environment."))})),(0,react__WEBPACK_IMPORTED_MODULE_0__.useEffect)((function(){"undefined"!=typeof window&&Object.values(Setting).forEach((function(setting){null!==JSON.parse(localStorage.getItem(setting))&&updateState({type:setting,payload:JSON.parse(localStorage.getItem(setting))})}))}),[]);var changeSetting=function changeSetting(setting,value){return updateState({type:setting,payload:value})};return __jsx(SettingsContext.Provider,{value:{settings,changeSetting}},children)};SettingsProvider.displayName="SettingsProvider";const __WEBPACK_DEFAULT_EXPORT__=SettingsContext;SettingsProvider.__docgenInfo={description:"",methods:[],displayName:"SettingsProvider",props:{children:{required:!0,tsType:{name:"ReactNode"},description:""}}};try{SettingsProvider.displayName="SettingsProvider",SettingsProvider.__docgenInfo={description:"",displayName:"SettingsProvider",props:{}},"undefined"!=typeof STORYBOOK_REACT_CLASSES&&(STORYBOOK_REACT_CLASSES["src/contexts/SettingsContext.tsx#SettingsProvider"]={docgenInfo:SettingsProvider.__docgenInfo,name:"SettingsProvider",path:"src/contexts/SettingsContext.tsx#SettingsProvider"})}catch(__react_docgen_typescript_loader_error){}}}]);